<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Transaction receipt</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --paper-width:320px; /* approximate width of phone receipt photo */
      --accent: #0373A7;
      --stamp-color: rgba(3,115,167,0.08);
      --body-font: 'Roboto', Arial, sans-serif;
      --mono-font: 'Roboto Mono', 'Courier New', monospace;
    }

    /* Page background to mimic phone photo */
    body{background:#222;display:flex;align-items:center;justify-content:center;min-height:100vh;margin:20px}

    /* Receipt paper */
    .receipt{
      width:var(--paper-width);
      background:#fff;padding:14px 12px;border-radius:8px;box-shadow:0 8px 30px rgba(0,0,0,0.45);font-family:var(--body-font);color:#111;position:relative;overflow:hidden;
    }

    /* Very light repeating watermark stamp pattern (CSS only) */
    .receipt::before{
      content:'';position:absolute;inset:-20% -10% -20% -10%;pointer-events:none;opacity:0.6;
      background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='120' height='120'><g fill='%230373A7' opacity='0.06'><circle cx='60' cy='30' r='22'/><rect x='28' y='58' width='64' height='46' rx='8'/></g></svg>");
      background-size:120px 120px;transform:rotate(-6deg);
    }

    header{display:flex;flex-direction:column;align-items:center;text-align:center;padding-bottom:8px;border-bottom:1px dashed #ddd}
    header .brand{font-weight:700;letter-spacing:1px;font-size:15px}
    header .sub{font-size:11px;color:#444;margin-top:2px}

    .section{padding:8px 0;border-bottom:1px dashed #eee}
    .row{display:flex;justify-content:space-between;align-items:center;font-size:13px}
    .muted{font-size:12px;color:#666}
    .amount{font-weight:700}

    .details{font-size:13px;line-height:1.38}
    .small{font-size:11px;color:#555}

    /* Emphasize booking ID with monospace similar to receipt printing */
    .booking{font-family:var(--mono-font);font-weight:700;letter-spacing:2px}

    .agent{font-size:13px}

    footer{font-size:10px;color:#444;text-align:center;padding-top:8px}

    /* Make sure printed export looks like paper */
    @media print{
      body{background:#fff}
      .receipt{box-shadow:none;border-radius:0}
    }

    /* Fine spacing adjustments to match the photograph proportions */
    .muted, .small{line-height:1.4}
    .section.details div{margin:4px 0}

    /* Make sure printed export looks like paper */
@media print {

  /* Remove background */
  body {
      background: #fff !important;
  }

  /* Remove shadows and borders on receipt */
  .receipt {
      box-shadow: none !important;
      border-radius: 0 !important;
  }

  /* ‚ùå Hide print button + links during printing */
  button, a {
      display: none !important;
  }

  /* ‚úî Make text brighter and more readable */
  body, .receipt {
      color: #000 !important;
  }

  /* ‚úî Increase general text size for printing */
  .receipt {
      font-size: 16px !important;
  }

  .row, .muted, .small, .details, footer {
      font-size: 15px !important;
  }

  header .brand {
      font-size: 20px !important;
      font-weight: 700 !important;
  }

  header .sub {
      font-size: 14px !important;
  }

  .amount {
      font-size: 18px !important;
      font-weight: bold !important;
  }
}

{% comment %} TO FORCE THE PRINTING TO BE CONDUCTED IN ONE PAPER ONLY {% endcomment %}
  
{% comment %} 1. REMOVE default browser margins on print {% endcomment %}
@page {
    margin: 0;
}

{% comment %} 2. Force the entire receipt to stay on one page, This stops the browser from splitting your receipt into 2 pages. {% endcomment %}

@media print {
    .receipt {
        page-break-inside: avoid !important;
        height: auto !important;
        max-height: 100% !important;
    }
}
{% comment %} REDUCING SPACE {% endcomment %}
@media print {
    .receipt {
        padding: 10px !important;
    }
    .section {
        padding: 5px 0 !important;
    }
}

{% comment %} 4. Scale the entire printed page slightly {% endcomment %}
 @media print {
    body {
        zoom: 0.90;  /* adjusts size to fit one sheet */
    }
}

</style>
</head>
<body>

  <div class="receipt">
    <header>
      <div class="brand">MICHAEL DRINKS STORE</div>
      <div class="sub">Transaction Receipt ‚Äî Sales Receipt</div>
      <div class=""><strong>{{ transaction.tripstatics.car_id }}</strong></div>
    </header>

    <div class="section">
      <div class="row"><div class="muted">USERNAME</div><div class="booking">{{ transaction.user.username }}</div></div>
      <div class="row"><div class="muted">Transaction type</div><div class="small">{{ transaction.transaction_type|title }}</div></div>
      <div class="row"><div class="muted">status</div><div class="small">{{ transaction.status|title }}</div></div>
      <div class="row"><div class="muted">Journey route</div><div class="small">{{ transaction.tripstatics.start }} TO {{ transaction.tripstatics.destination }} </div></div>
      <div class="row"><div class="muted">Date</div><div class="small">{{transaction.created_on}}</div></div>
    </div>

    <div class="section">
      <div class="row"><div class="muted">No of soda</div><div class="muted">{{ transaction.soda_amount}}</div></div>
      <div class="row"><div class="muted">No of water</div><div class="muted">{{ transaction.water_amount}}</div></div>
      {% if transaction.status == "confirmed" %}
      <div class="row"><div class="muted">Total Amount</div><div class="amount">TZS {{total_price}}</div></div>
      {% else %} 
        <div class="row">Transaction has been {{ transaction.status }} by {{ transaction.confirmed_by.username }}</div>
    {% endif %}
    </div>

    <div class="section details">
      <div><strong>Going Trip Date : </strong> {{ transaction.tripstatics.trip_date }}</div>
      <div><strong>Going Trip :</strong> {{ transaction.tripstatics.start }} -- {{ transaction.tripstatics.destination }}</div>
      <div><strong>Number of passengers : </strong>{{ transaction.tripstatics.passenger_number }}Psg</div>
      <br><br>
      <div><strong>Return Trip Date : </strong> {{ transaction.tripstatics.return_trip_date }}</div>
      <div><strong>Return Trip : </strong> {{ transaction.tripstatics.return_start }} ‚Äî {{ transaction.tripstatics.return_destination }}</div>
      <div><strong>Number of passengers : </strong> {{ transaction.tripstatics.return_passenger_number }}Psg</div>
      
    </div>

    <div class="section">
      <div class="row"><div class="muted">Requested at:</div><div class="agent">{{transaction.created_at}} <b>On</b> {{transaction.created_on}}</div></div>
    </div>

    

    <footer>
      <div class="small"><a href="{% url 'home'%}">HOME</a></div>
      {% if transaction.status == "confirmed" %}
      <button onclick="window.print()">üñ®</button>
      {% else %} 
      <div class="small"><a href="{% url 'pending_transactions' %}">Back to Pending Transactions</a></div>
      {% endif%}
      <a href="{% url 'download_receipt' transaction.id %}" class="btn btn-primary">Download PDF</a>

      <div class="small">12/11/2025 15:14 ‚Äî System version: 1.0(25)</div>
      <div class="small">Thank you for using our services</div>
      
      


    </footer>
  </div>
  
</body>
</html>
